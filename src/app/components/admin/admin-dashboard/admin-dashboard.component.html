<h2 class="h4 fw-bold mb-4">ðŸ“¦ Admin Dashboard - Orders</h2>

<!-- Filters -->
<div class="row g-3 mb-3">
  <div class="col-md-3">
    <input type="text" class="form-control" placeholder="Search by Email/Phone/UserId" [(ngModel)]="searchTerm" />
  </div>
  <div class="col-md-3">
    <input type="date" class="form-control" [(ngModel)]="fromDate" />
  </div>
  <div class="col-md-3">
    <input type="date" class="form-control" [(ngModel)]="toDate" />
  </div>
  <div class="col-md-3 d-flex">
    <button class="btn btn-primary me-2" (click)="getOrders()">Search</button>
    <button class="btn btn-outline-secondary" (click)="clearFilters()">Reset</button>
  </div>
</div>

<button class="btn btn-success mb-3" (click)="exportToExcel()">ðŸ“¥ Export Orders</button>

<div *ngIf="isLoading" class="alert alert-info text-center">Loading orders...</div>
<div *ngIf="!isLoading && orders.length === 0" class="alert alert-warning text-center">No orders found.</div>

<table class="table table-bordered table-hover" *ngIf="orders.length > 0">
  <thead class="table-light">
    <tr>
      <th>User</th>
      <th>Email</th>
      <th>Total</th>
      <th>Status</th>
      <th>Products</th>
      <th>Update Status</th>
    </tr>
  </thead>
  <tbody>
    <tr *ngFor="let order of orders">
      <td>{{ order.userId?.name }}</td>
      <td>{{ order.userId?.email }}</td>
      <td>â‚¹{{ order.totalAmount }}</td>
      <td class="text-primary fw-semibold text-capitalize">{{ order.status }}</td>
      <td>
        <ul class="ps-3 mb-0">
          <li *ngFor="let item of order.products">
            {{ item.name }} Ã— {{ item.quantity }}
          </li>
        </ul>
      </td>
      <td>
        <div class="d-flex">
          <select [(ngModel)]="order.selectedStatus" class="form-select form-select-sm me-2 w-auto">
            <option value="processing">Processing</option>
            <option value="confirmed">Confirmed</option>
            <option value="shippedtopune">Shipped to Pune</option>
            <option value="deliveryday">Out for Delivery</option>
            <option value="complete">Delivered</option>
          </select>
          <button class="btn btn-primary btn-sm" (click)="updateStatus(order)">Update</button>
        </div>
      </td>
    </tr>
  </tbody>
</table>
